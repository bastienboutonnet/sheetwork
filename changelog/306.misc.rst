Adds test coverage to many more parts of the code bringing it from 67% to 80+
